<script lang="ts">
	import { Dialog } from 'bits-ui';
	import { getContext } from 'svelte';
	import IonosFeedback from './IonosFeedback.svelte';
	import IonosRegister from './IonosRegister.svelte';
	import { feedbackDialog, mobile, user } from '$lib/stores';

	const i18n = getContext('i18n');

	let registerDialogOpen: boolean;
</script>

<header class="ionos-header z-10">
	<div class="header-left">
		<a href="/">
			<svg
				id="ionos-logo"
				width="90"
				height="26"
				viewBox="0 0 90 26"
				xmlns="http://www.w3.org/2000/svg"
			>
				<path
					d="M82.419 25.9966C81.9783 25.9978 81.5387 25.9531 81.1072 25.8633C80.1782 25.6713 79.2997 25.2868 78.5283 24.7347C77.7569 24.1826 77.1097 23.475 76.6283 22.6576L76.6038 22.612C76.3649 22.1595 76.307 21.633 76.4418 21.1394C76.5767 20.6457 76.8941 20.2218 77.3298 19.9534C77.6316 19.7719 77.9772 19.6761 78.3294 19.6764C78.6802 19.6769 79.0246 19.7707 79.3272 19.9482C79.6299 20.1257 79.8798 20.3805 80.0515 20.6865L80.1182 20.7987L80.3286 21.0828L80.6092 21.3669C80.9741 21.6826 81.4156 21.8967 81.8894 21.9877C82.2726 22.0618 82.667 22.0552 83.0475 21.9682C83.4279 21.8813 83.7861 21.7159 84.099 21.4826C84.4223 21.2526 84.6904 20.9536 84.8839 20.6073C85.0774 20.2609 85.1915 19.8758 85.2178 19.4799C85.2503 19.0881 85.1986 18.6938 85.0661 18.3236C84.9336 17.9534 84.7234 17.6158 84.4497 17.3335C84.4497 17.3335 77.9822 10.6695 77.8419 10.4836L77.5227 10.0101C76.766 8.82906 76.4242 7.42965 76.5512 6.03276C76.6204 5.06483 76.9069 4.12495 77.3894 3.283L77.67 2.79197C78.1805 2.06188 78.848 1.45545 79.6236 1.01725L79.9428 0.789271C81.4348 -0.0308526 83.1889 -0.233107 84.8284 0.225951C86.4679 0.68501 87.862 1.76876 88.7112 3.24442C88.8435 3.46712 88.9297 3.71415 88.9646 3.97082C88.9996 4.2275 88.9826 4.48858 88.9146 4.73855C88.8473 4.99304 88.7297 5.23149 88.5689 5.4399C88.4081 5.6483 88.2072 5.82245 87.9781 5.95209C87.6863 6.12522 87.353 6.21612 87.0136 6.21514C86.6647 6.21419 86.3223 6.12046 86.0215 5.94358C85.7208 5.76669 85.4724 5.51301 85.302 5.20853C85.117 4.89366 84.8671 4.6217 84.569 4.41067C84.2709 4.19964 83.9314 4.05437 83.5729 3.98447C83.2085 3.91349 82.8333 3.91893 82.471 4.00043C82.1088 4.08193 81.7674 4.23773 81.4685 4.45796C81.1813 4.68181 80.9451 4.96434 80.7758 5.28671C80.6064 5.60908 80.5078 5.96386 80.4864 6.32738C80.4561 6.69228 80.5028 7.05949 80.6237 7.40513C80.7445 7.75077 80.9368 8.06711 81.1879 8.33358L87.2661 14.6012C88.1829 15.5525 88.7994 16.7526 89.0385 18.0519C89.2776 19.3512 89.1289 20.6922 88.6108 21.9075C88.0927 23.1228 87.2283 24.1587 86.1253 24.8859C85.0223 25.6131 83.7296 25.9994 82.4085 25.9966H82.419Z"
				/>
				<path
					d="M63.1919 25.993C61.4595 25.9911 59.7986 25.3021 58.5736 24.0771C57.3486 22.8521 56.6596 21.1912 56.6577 19.4588V6.5342C56.6577 5.67611 56.8267 4.82643 57.1551 4.03367C57.4835 3.2409 57.9648 2.52058 58.5715 1.91382C59.1783 1.30707 59.8986 0.82576 60.6914 0.497386C61.4841 0.169012 62.3338 0 63.1919 0C64.05 0 64.8997 0.169012 65.6924 0.497386C66.4852 0.82576 67.2055 1.30707 67.8123 1.91382C68.419 2.52058 68.9003 3.2409 69.2287 4.03367C69.5571 4.82643 69.7261 5.67611 69.7261 6.5342V19.4588C69.7243 21.1912 69.0352 22.8521 67.8102 24.0771C66.5852 25.3021 64.9243 25.9911 63.1919 25.993ZM63.1919 3.94577C62.5057 3.9467 61.8479 4.21971 61.3626 4.70493C60.8774 5.19015 60.6044 5.84799 60.6035 6.5342V19.4588C60.5997 19.7997 60.6641 20.138 60.7929 20.4538C60.9216 20.7695 61.1121 21.0563 61.3532 21.2975C61.5944 21.5386 61.8812 21.7291 62.1969 21.8578C62.5127 21.9866 62.851 22.051 63.1919 22.0472C63.8781 22.0463 64.536 21.7733 65.0212 21.2881C65.5064 20.8028 65.7794 20.145 65.7803 19.4588V6.5342C65.7713 5.85053 65.4956 5.19741 65.0122 4.71394C64.5287 4.23048 63.8756 3.95485 63.1919 3.94577Z"
				/>
				<path
					d="M37.8124 13.3315V24.0394C37.8124 24.5622 37.6047 25.0636 37.235 25.4332C36.8654 25.8029 36.364 26.0106 35.8413 26.0106C35.3185 26.0106 34.8171 25.8029 34.4475 25.4332C34.0778 25.0636 33.8701 24.5622 33.8701 24.0394V5.14532L37.8124 13.3315ZM48.4572 20.8583V1.97117C48.4357 1.46232 48.2185 0.98144 47.8509 0.628979C47.4832 0.276517 46.9936 0.079733 46.4843 0.079733C45.975 0.079733 45.4854 0.276517 45.1178 0.628979C44.7501 0.98144 44.5329 1.46232 44.5114 1.97117V12.6686L48.4572 20.8583ZM37.6265 1.11888V1.0803C37.4488 0.762505 37.1899 0.497618 36.8762 0.312741C36.5625 0.127863 36.2054 0.0296321 35.8413 0.0280966C35.708 0.0274633 35.5751 0.0415785 35.4449 0.0701848C35.0015 0.156527 34.6026 0.395996 34.318 0.746708C34.0333 1.09742 33.881 1.53705 33.8877 1.98871V2.44115L44.7113 24.9128C44.8811 25.2326 45.1331 25.5013 45.4414 25.6912C45.7496 25.8811 46.103 25.9853 46.465 25.993C46.6176 25.9934 46.7696 25.9745 46.9175 25.9369C47.3531 25.8458 47.7441 25.6074 48.0245 25.2618C48.3049 24.9162 48.4577 24.4845 48.4572 24.0394V23.594C48.4572 23.594 37.9176 1.71864 37.6265 1.11888Z"
				/>
				<path
					d="M19.0796 25.993C17.3469 25.9921 15.6855 25.3033 14.4603 24.0781C13.2351 22.8529 12.5463 21.1915 12.5454 19.4588V6.5342C12.5454 4.80122 13.2338 3.13922 14.4592 1.91382C15.6846 0.688422 17.3466 0 19.0796 0C20.8126 0 22.4746 0.688422 23.7 1.91382C24.9254 3.13922 25.6138 4.80122 25.6138 6.5342V19.4588C25.6129 21.1915 24.9242 22.8529 23.699 24.0781C22.4738 25.3033 20.8123 25.9921 19.0796 25.993ZM19.0796 3.94577C18.7396 3.94531 18.4028 4.01195 18.0885 4.14186C17.7743 4.27178 17.4887 4.46242 17.2483 4.70287C17.0078 4.94332 16.8172 5.22885 16.6873 5.5431C16.5574 5.85735 16.4907 6.19415 16.4912 6.5342V19.4588C16.4912 20.1453 16.7639 20.8037 17.2493 21.2891C17.7347 21.7745 18.3931 22.0472 19.0796 22.0472C19.7661 22.0472 20.4245 21.7745 20.9099 21.2891C21.3953 20.8037 21.668 20.1453 21.668 19.4588V6.5342C21.659 5.85053 21.3833 5.19741 20.8999 4.71394C20.4164 4.23047 19.7633 3.95485 19.0796 3.94577Z"
				/>
				<path
					d="M2.14279 25.9827C1.85889 25.9841 1.57756 25.9288 1.3153 25.8201C1.05305 25.7114 0.815137 25.5514 0.615534 25.3495C0.41593 25.1476 0.25865 24.9079 0.152917 24.6444C0.0471839 24.3809 -0.00487247 24.099 -0.000199355 23.8151V2.11513C0.0099449 1.55105 0.242119 1.01373 0.645944 0.619752C1.04977 0.225777 1.59266 0.00693882 2.15682 0.0107235C2.62925 0.00381055 3.09025 0.156078 3.46562 0.443013C3.84099 0.729947 4.10888 1.13485 4.22616 1.59254C4.24062 1.64213 4.25233 1.69248 4.26123 1.74336V1.83805C4.28131 1.95386 4.2907 2.07126 4.28929 2.18879C4.28929 2.18879 4.28929 23.5836 4.28929 23.8292C4.29115 24.1119 4.23694 24.3922 4.12982 24.6538C4.02269 24.9155 3.86476 25.1533 3.66516 25.3536C3.46556 25.5538 3.22825 25.7125 2.96695 25.8205C2.70564 25.9285 2.42553 25.9836 2.14279 25.9827Z"
				/>
			</svg>
		</a>
	</div>

	<div class="header-right">
		<Dialog.Root bind:open={registerDialogOpen}>
			<Dialog.Trigger class="px-4 py-2 exos-button exos-button--primary exos-button--ellipsized"
				>{$i18n.t('Sign up')}
			</Dialog.Trigger>
			<IonosRegister dialogOpen={registerDialogOpen} />
		</Dialog.Root>
		{#if $user}
			<Dialog.Root bind:open={$feedbackDialog.open}>
				<Dialog.Trigger
					class="px-4 py-2 exos-button exos-button--secondary
				{$mobile ? 'exos-button--icon-only' : 'exos-button--ellipsized'}
				"
				>
					{#if $mobile}
						<span class="exos-button__icon exos-exos-icon exos-exos-icon-feedback-14"></span><span
							class="exos-button__text">{$i18n.t('Feedback', { ns: 'ionos' })}</span
						>
					{:else}
						{$i18n.t('Feedback', { ns: 'ionos' })}
					{/if}
				</Dialog.Trigger>
				<IonosFeedback dialogOpen={$feedbackDialog.open} noRating={$feedbackDialog.rating !== -1} />
			</Dialog.Root>
		{/if}
	</div>
</header>

<style>
	@import './ionos-variables.css';
	.ionos-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: 0 24px;
		height: 64px;
		background-color: var(--ion-background-color);
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
	}

	.header-left {
		display: flex;
		align-items: center;
	}

	.header-right {
		display: flex;
		align-items: center;
	}

	#ionos-logo {
		fill: var(--ion-brand-color);
	}
</style>
